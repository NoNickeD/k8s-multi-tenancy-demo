# Capsule Helm Chart Values
# Namespace-based multi-tenancy for Kubernetes

manager:
  # Force tenant prefix on namespace names to avoid conflicts
  options:
    forceTenantPrefix: true
    # Enable capsule to manage storage classes
    capsuleUserGroups:
      - projectcapsule.dev
    # Protected namespaces regex - cannot be managed by tenants
    protectedNamespaceRegex: "^(kube-system|kube-public|kube-node-lease|capsule-system|argocd|monitoring|prometheus|grafana|cert-manager|external-secrets)$"

  # Resource limits for Capsule manager
  resources:
    limits:
      cpu: 200m
      memory: 256Mi
    requests:
      cpu: 100m
      memory: 128Mi

  # Node selector to run on system node pool
  nodeSelector:
    nodepool-type: system

  # Tolerations
  tolerations:
    - key: CriticalAddonsOnly
      operator: Exists
      effect: NoSchedule

  # RBAC
  rbac:
    create: true

# Webhook configuration
webhooks:
  # Webhook service configuration
  service: {}

  # Webhook pods
  hooks: {}

# Separate webhook deployment (if needed)
webhook:
  resources:
    limits:
      cpu: 200m
      memory: 256Mi
    requests:
      cpu: 100m
      memory: 128Mi

  # Node selector to run on system node pool
  nodeSelector:
    nodepool-type: system

  # Tolerations
  tolerations:
    - key: CriticalAddonsOnly
      operator: Exists
      effect: NoSchedule

# Service monitor for Prometheus
monitoring:
  serviceMonitor:
    enabled: true
    labels:
      release: prometheus

# Service Account
serviceAccount:
  create: true
